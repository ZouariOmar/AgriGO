\doxysection{JWT.\+php}
\hypertarget{JWT_8php_source}{}\label{JWT_8php_source}\index{/home/zouari\_omar/Documents/Daily/Projects/AgriGO/vendor/firebase/php-\/jwt/src/JWT.php@{/home/zouari\_omar/Documents/Daily/Projects/AgriGO/vendor/firebase/php-\/jwt/src/JWT.php}}

\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00001}00001\ <?php}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00002}00002\ }
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00003}00003\ \textcolor{keyword}{namespace\ }Firebase\(\backslash\)JWT;}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00004}00004\ }
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00005}00005\ use\ ArrayAccess;}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00006}00006\ use\ DateTime;}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00007}00007\ use\ DomainException;}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00008}00008\ use\ Exception;}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00009}00009\ use\ InvalidArgumentException;}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00010}00010\ use\ OpenSSLAsymmetricKey;}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00011}00011\ use\ OpenSSLCertificate;}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00012}00012\ use\ stdClass;}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00013}00013\ use\ UnexpectedValueException;}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00014}00014\ }
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00028}\mbox{\hyperlink{classFirebase_1_1JWT_1_1JWT}{00028}}\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classFirebase_1_1JWT_1_1JWT}{JWT}}}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00029}00029\ \{}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00030}00030\ \ \ \ \ \textcolor{keyword}{private}\ \textcolor{keyword}{const}\ ASN1\_INTEGER\ =\ 0x02;}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00031}00031\ \ \ \ \ \textcolor{keyword}{private}\ \textcolor{keyword}{const}\ ASN1\_SEQUENCE\ =\ 0x10;}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00032}00032\ \ \ \ \ \textcolor{keyword}{private}\ \textcolor{keyword}{const}\ ASN1\_BIT\_STRING\ =\ 0x03;}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00033}00033\ }
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00041}00041\ \ \ \ \ \textcolor{keyword}{public}\ \textcolor{keyword}{static}\ \$leeway\ =\ 0;}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00042}00042\ }
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00050}00050\ \ \ \ \ \textcolor{keyword}{public}\ \textcolor{keyword}{static}\ \$timestamp\ =\ \textcolor{keyword}{null};}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00051}00051\ }
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00055}00055\ \ \ \ \ \textcolor{keyword}{public}\ \textcolor{keyword}{static}\ \$supported\_algs\ =\ [}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00056}00056\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'ES384'}\ =>\ [\textcolor{stringliteral}{'openssl'},\ \textcolor{stringliteral}{'SHA384'}],}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00057}00057\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'ES256'}\ =>\ [\textcolor{stringliteral}{'openssl'},\ \textcolor{stringliteral}{'SHA256'}],}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00058}00058\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'ES256K'}\ =>\ [\textcolor{stringliteral}{'openssl'},\ \textcolor{stringliteral}{'SHA256'}],}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00059}00059\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'HS256'}\ =>\ [\textcolor{stringliteral}{'hash\_hmac'},\ \textcolor{stringliteral}{'SHA256'}],}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00060}00060\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'HS384'}\ =>\ [\textcolor{stringliteral}{'hash\_hmac'},\ \textcolor{stringliteral}{'SHA384'}],}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00061}00061\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'HS512'}\ =>\ [\textcolor{stringliteral}{'hash\_hmac'},\ \textcolor{stringliteral}{'SHA512'}],}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00062}00062\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'RS256'}\ =>\ [\textcolor{stringliteral}{'openssl'},\ \textcolor{stringliteral}{'SHA256'}],}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00063}00063\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'RS384'}\ =>\ [\textcolor{stringliteral}{'openssl'},\ \textcolor{stringliteral}{'SHA384'}],}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00064}00064\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'RS512'}\ =>\ [\textcolor{stringliteral}{'openssl'},\ \textcolor{stringliteral}{'SHA512'}],}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00065}00065\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'EdDSA'}\ =>\ [\textcolor{stringliteral}{'sodium\_crypto'},\ \textcolor{stringliteral}{'EdDSA'}],}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00066}00066\ \ \ \ \ ];}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00067}00067\ }
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00096}\mbox{\hyperlink{classFirebase_1_1JWT_1_1JWT_a6338df478e275925dc3aaa0ef85f6c07}{00096}}\ \ \ \ \ \textcolor{keyword}{public}\ \textcolor{keyword}{static}\ \textcolor{keyword}{function}\ \mbox{\hyperlink{classFirebase_1_1JWT_1_1JWT_a6338df478e275925dc3aaa0ef85f6c07}{decode}}(}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00097}00097\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{string}\ \$jwt,}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00098}00098\ \ \ \ \ \ \ \ \ \$keyOrKeyArray,}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00099}00099\ \ \ \ \ \ \ \ \ stdClass\ \&\$headers\ =\ \textcolor{keyword}{null}}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00100}00100\ \ \ \ \ ):\ stdClass\ \{}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00101}00101\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Validate\ JWT}}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00102}00102\ \ \ \ \ \ \ \ \ \$timestamp\ =\ \(\backslash\)is\_null(static::\$timestamp)\ ?\ \(\backslash\)time()\ :\ static::\$timestamp;}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00103}00103\ }
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00104}00104\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (empty(\$keyOrKeyArray))\ \{}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00105}00105\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ \textcolor{keyword}{new}\ InvalidArgumentException(\textcolor{stringliteral}{'Key\ may\ not\ be\ empty'});}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00106}00106\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00107}00107\ \ \ \ \ \ \ \ \ \$tks\ =\ \(\backslash\)explode(\textcolor{charliteral}{'.'},\ \$jwt);}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00108}00108\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\(\backslash\)count(\$tks)\ !==\ 3)\ \{}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00109}00109\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ \textcolor{keyword}{new}\ UnexpectedValueException(\textcolor{stringliteral}{'Wrong\ number\ of\ segments'});}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00110}00110\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00111}00111\ \ \ \ \ \ \ \ \ list(\$headb64,\ \$bodyb64,\ \$cryptob64)\ =\ \$tks;}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00112}00112\ \ \ \ \ \ \ \ \ \$headerRaw\ =\ static::urlsafeB64Decode(\$headb64);}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00113}00113\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\textcolor{keyword}{null}\ ===\ (\$header\ =\ static::jsonDecode(\$headerRaw)))\ \{}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00114}00114\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ \textcolor{keyword}{new}\ UnexpectedValueException(\textcolor{stringliteral}{'Invalid\ header\ encoding'});}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00115}00115\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00116}00116\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\$headers\ !==\ \textcolor{keyword}{null})\ \{}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00117}00117\ \ \ \ \ \ \ \ \ \ \ \ \ \$headers\ =\ \$header;}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00118}00118\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00119}00119\ \ \ \ \ \ \ \ \ \$payloadRaw\ =\ static::urlsafeB64Decode(\$bodyb64);}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00120}00120\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\textcolor{keyword}{null}\ ===\ (\$payload\ =\ static::jsonDecode(\$payloadRaw)))\ \{}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00121}00121\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ \textcolor{keyword}{new}\ UnexpectedValueException(\textcolor{stringliteral}{'Invalid\ claims\ encoding'});}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00122}00122\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00123}00123\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\(\backslash\)is\_array(\$payload))\ \{}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00124}00124\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ prevent\ PHP\ Fatal\ Error\ in\ edge-\/cases\ when\ payload\ is\ empty\ array}}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00125}00125\ \ \ \ \ \ \ \ \ \ \ \ \ \$payload\ =\ (object)\ \$payload;}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00126}00126\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00127}00127\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!\$payload\ instanceof\ stdClass)\ \{}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00128}00128\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ \textcolor{keyword}{new}\ UnexpectedValueException(\textcolor{stringliteral}{'Payload\ must\ be\ a\ JSON\ object'});}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00129}00129\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00130}00130\ \ \ \ \ \ \ \ \ \$sig\ =\ static::urlsafeB64Decode(\$cryptob64);}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00131}00131\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (empty(\$header-\/>alg))\ \{}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00132}00132\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ \textcolor{keyword}{new}\ UnexpectedValueException(\textcolor{stringliteral}{'Empty\ algorithm'});}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00133}00133\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00134}00134\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (empty(static::\$supported\_algs[\$header-\/>alg]))\ \{}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00135}00135\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ \textcolor{keyword}{new}\ UnexpectedValueException(\textcolor{stringliteral}{'Algorithm\ not\ supported'});}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00136}00136\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00137}00137\ }
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00138}00138\ \ \ \ \ \ \ \ \ \$key\ =\ self::getKey(\$keyOrKeyArray,\ property\_exists(\$header,\ \textcolor{stringliteral}{'kid'})\ ?\ \$header-\/>kid\ :\ null);}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00139}00139\ }
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00140}00140\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Check\ the\ algorithm}}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00141}00141\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!self::constantTimeEquals(\$key-\/>getAlgorithm(),\ \$header-\/>alg))\ \{}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00142}00142\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ See\ issue\ \#351}}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00143}00143\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ \textcolor{keyword}{new}\ UnexpectedValueException(\textcolor{stringliteral}{'Incorrect\ key\ for\ this\ algorithm'});}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00144}00144\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00145}00145\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\(\backslash\)in\_array(\$header-\/>alg,\ [\textcolor{stringliteral}{'ES256'},\ \textcolor{stringliteral}{'ES256K'},\ \textcolor{stringliteral}{'ES384'}],\ \textcolor{keyword}{true}))\ \{}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00146}00146\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ OpenSSL\ expects\ an\ ASN.1\ DER\ sequence\ for\ ES256/ES256K/ES384\ signatures}}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00147}00147\ \ \ \ \ \ \ \ \ \ \ \ \ \$sig\ =\ self::signatureToDER(\$sig);}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00148}00148\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00149}00149\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!self::verify(\textcolor{stringliteral}{"{}\{\$headb64\}.\{\$bodyb64\}"{}},\ \$sig,\ \$key-\/>getKeyMaterial(),\ \$header-\/>alg))\ \{}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00150}00150\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ \textcolor{keyword}{new}\ SignatureInvalidException(\textcolor{stringliteral}{'Signature\ verification\ failed'});}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00151}00151\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00152}00152\ }
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00153}00153\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Check\ the\ nbf\ if\ it\ is\ defined.\ This\ is\ the\ time\ that\ the}}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00154}00154\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ token\ can\ actually\ be\ used.\ If\ it's\ not\ yet\ that\ time,\ abort.}}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00155}00155\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (isset(\$payload-\/>nbf)\ \&\&\ \mbox{\hyperlink{namespaceCarbon_1_1Traits_a78632d00b6037e57b7641da7ecf909db}{floor}}(\$payload-\/>nbf)\ >\ (\$timestamp\ +\ static::\$leeway))\ \{}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00156}00156\ \ \ \ \ \ \ \ \ \ \ \ \ \$ex\ =\ \textcolor{keyword}{new}\ BeforeValidException(}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00157}00157\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'Cannot\ handle\ token\ with\ nbf\ prior\ to\ '}\ .\ \(\backslash\)date(DateTime::ISO8601,\ (\textcolor{keywordtype}{int})\ \$payload-\/>nbf)}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00158}00158\ \ \ \ \ \ \ \ \ \ \ \ \ );}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00159}00159\ \ \ \ \ \ \ \ \ \ \ \ \ \$ex-\/>setPayload(\$payload);}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00160}00160\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ \$ex;}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00161}00161\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00162}00162\ }
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00163}00163\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Check\ that\ this\ token\ has\ been\ created\ before\ 'now'.\ This\ prevents}}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00164}00164\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ using\ tokens\ that\ have\ been\ created\ for\ later\ use\ (and\ haven't}}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00165}00165\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ correctly\ used\ the\ nbf\ claim).}}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00166}00166\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!isset(\$payload-\/>nbf)\ \&\&\ isset(\$payload-\/>iat)\ \&\&\ \mbox{\hyperlink{namespaceCarbon_1_1Traits_a78632d00b6037e57b7641da7ecf909db}{floor}}(\$payload-\/>iat)\ >\ (\$timestamp\ +\ static::\$leeway))\ \{}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00167}00167\ \ \ \ \ \ \ \ \ \ \ \ \ \$ex\ =\ \textcolor{keyword}{new}\ BeforeValidException(}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00168}00168\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'Cannot\ handle\ token\ with\ iat\ prior\ to\ '}\ .\ \(\backslash\)date(DateTime::ISO8601,\ (\textcolor{keywordtype}{int})\ \$payload-\/>iat)}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00169}00169\ \ \ \ \ \ \ \ \ \ \ \ \ );}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00170}00170\ \ \ \ \ \ \ \ \ \ \ \ \ \$ex-\/>setPayload(\$payload);}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00171}00171\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ \$ex;}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00172}00172\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00173}00173\ }
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00174}00174\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Check\ if\ this\ token\ has\ expired.}}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00175}00175\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (isset(\$payload-\/>exp)\ \&\&\ (\$timestamp\ -\/\ static::\$leeway)\ >=\ \$payload-\/>exp)\ \{}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00176}00176\ \ \ \ \ \ \ \ \ \ \ \ \ \$ex\ =\ \textcolor{keyword}{new}\ ExpiredException(\textcolor{stringliteral}{'Expired\ token'});}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00177}00177\ \ \ \ \ \ \ \ \ \ \ \ \ \$ex-\/>setPayload(\$payload);}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00178}00178\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ \$ex;}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00179}00179\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00180}00180\ }
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00181}00181\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \$payload;}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00182}00182\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00183}00183\ }
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00199}\mbox{\hyperlink{classFirebase_1_1JWT_1_1JWT_a2b06448b21b7838905336923509380df}{00199}}\ \ \ \ \ \textcolor{keyword}{public}\ \textcolor{keyword}{static}\ \textcolor{keyword}{function}\ \mbox{\hyperlink{classFirebase_1_1JWT_1_1JWT_a2b06448b21b7838905336923509380df}{encode}}(}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00200}00200\ \ \ \ \ \ \ \ \ array\ \$payload,}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00201}00201\ \ \ \ \ \ \ \ \ \$key,}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00202}00202\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{string}\ \$alg,}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00203}00203\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{string}\ \$keyId\ =\ \textcolor{keyword}{null},}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00204}00204\ \ \ \ \ \ \ \ \ array\ \$head\ =\ \textcolor{keyword}{null}}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00205}00205\ \ \ \ \ ):\ string\ \{}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00206}00206\ \ \ \ \ \ \ \ \ \$header\ =\ [\textcolor{stringliteral}{'typ'}\ =>\ \textcolor{stringliteral}{'JWT'}];}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00207}00207\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (isset(\$head)\ \&\&\ \(\backslash\)is\_array(\$head))\ \{}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00208}00208\ \ \ \ \ \ \ \ \ \ \ \ \ \$header\ =\ \(\backslash\)array\_merge(\$header,\ \$head);}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00209}00209\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00210}00210\ \ \ \ \ \ \ \ \ \$header[\textcolor{stringliteral}{'alg'}]\ =\ \$alg;}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00211}00211\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\$keyId\ !==\ \textcolor{keyword}{null})\ \{}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00212}00212\ \ \ \ \ \ \ \ \ \ \ \ \ \$header[\textcolor{stringliteral}{'kid'}]\ =\ \$keyId;}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00213}00213\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00214}00214\ \ \ \ \ \ \ \ \ \$segments\ =\ [];}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00215}00215\ \ \ \ \ \ \ \ \ \$segments[]\ =\ static::urlsafeB64Encode((\textcolor{keywordtype}{string})\ static::jsonEncode(\$header));}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00216}00216\ \ \ \ \ \ \ \ \ \$segments[]\ =\ static::urlsafeB64Encode((\textcolor{keywordtype}{string})\ static::jsonEncode(\$payload));}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00217}00217\ \ \ \ \ \ \ \ \ \$signing\_input\ =\ \(\backslash\)implode(\textcolor{charliteral}{'.'},\ \$segments);}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00218}00218\ }
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00219}00219\ \ \ \ \ \ \ \ \ \$signature\ =\ static::sign(\$signing\_input,\ \$key,\ \$alg);}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00220}00220\ \ \ \ \ \ \ \ \ \$segments[]\ =\ static::urlsafeB64Encode(\$signature);}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00221}00221\ }
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00222}00222\ \ \ \ \ \ \ \ \ return\ \(\backslash\)implode(\textcolor{charliteral}{'.'},\ \$segments);}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00223}00223\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00224}00224\ }
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00237}\mbox{\hyperlink{classFirebase_1_1JWT_1_1JWT_a548e26ef149cb38b50abe593e91895d6}{00237}}\ \ \ \ \ \textcolor{keyword}{public}\ \textcolor{keyword}{static}\ \textcolor{keyword}{function}\ \mbox{\hyperlink{classFirebase_1_1JWT_1_1JWT_a548e26ef149cb38b50abe593e91895d6}{sign}}(}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00238}00238\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{string}\ \$msg,}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00239}00239\ \ \ \ \ \ \ \ \ \$key,}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00240}00240\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{string}\ \$alg}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00241}00241\ \ \ \ \ ):\ string\ \{}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00242}00242\ \ \ \ \ \ \ \ \ if\ (empty(static::\$supported\_algs[\$alg]))\ \{}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00243}00243\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ \textcolor{keyword}{new}\ DomainException(\textcolor{stringliteral}{'Algorithm\ not\ supported'});}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00244}00244\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00245}00245\ \ \ \ \ \ \ \ \ list(\$function,\ \$algorithm)\ =\ static::\$supported\_algs[\$alg];}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00246}00246\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{switch}\ (\$function)\ \{}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00247}00247\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \textcolor{stringliteral}{'hash\_hmac'}:}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00248}00248\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!\(\backslash\)is\_string(\$key))\ \{}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00249}00249\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ \textcolor{keyword}{new}\ InvalidArgumentException(\textcolor{stringliteral}{'key\ must\ be\ a\ string\ when\ using\ hmac'});}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00250}00250\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00251}00251\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ return\ \(\backslash\)hash\_hmac(\$algorithm,\ \$msg,\ \$key,\ \textcolor{keyword}{true});}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00252}00252\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \textcolor{stringliteral}{'openssl'}:}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00253}00253\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \$signature\ =\ \textcolor{stringliteral}{''};}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00254}00254\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!\(\backslash\)is\_resource(\$key)\ \&\&\ !openssl\_pkey\_get\_private(\$key))\ \{}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00255}00255\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ \textcolor{keyword}{new}\ DomainException(\textcolor{stringliteral}{'OpenSSL\ unable\ to\ validate\ key'});}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00256}00256\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00257}00257\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \$success\ =\ \(\backslash\)openssl\_sign(\$msg,\ \$signature,\ \$key,\ \$algorithm);\ \textcolor{comment}{//\ @phpstan-\/ignore-\/line}}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00258}00258\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!\$success)\ \{}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00259}00259\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ \textcolor{keyword}{new}\ DomainException(\textcolor{stringliteral}{'OpenSSL\ unable\ to\ sign\ data'});}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00260}00260\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00261}00261\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\$alg\ ===\ \textcolor{stringliteral}{'ES256'}\ ||\ \$alg\ ===\ \textcolor{stringliteral}{'ES256K'})\ \{}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00262}00262\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \$signature\ =\ self::signatureFromDER(\$signature,\ 256);}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00263}00263\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}\ elseif\ (\$alg\ ===\ \textcolor{stringliteral}{'ES384'})\ \{}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00264}00264\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \$signature\ =\ self::signatureFromDER(\$signature,\ 384);}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00265}00265\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00266}00266\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \$signature;}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00267}00267\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \textcolor{stringliteral}{'sodium\_crypto'}:}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00268}00268\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!\(\backslash\)function\_exists(\textcolor{stringliteral}{'sodium\_crypto\_sign\_detached'}))\ \{}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00269}00269\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ \textcolor{keyword}{new}\ DomainException(\textcolor{stringliteral}{'libsodium\ is\ not\ available'});}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00270}00270\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00271}00271\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!\(\backslash\)is\_string(\$key))\ \{}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00272}00272\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ \textcolor{keyword}{new}\ InvalidArgumentException(\textcolor{stringliteral}{'key\ must\ be\ a\ string\ when\ using\ EdDSA'});}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00273}00273\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00274}00274\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{try}\ \{}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00275}00275\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ The\ last\ non-\/empty\ line\ is\ used\ as\ the\ key.}}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00276}00276\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \$lines\ =\ array\_filter(explode(\textcolor{stringliteral}{"{}\(\backslash\)n"{}},\ \$key));}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00277}00277\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \$key\ =\ base64\_decode((\textcolor{keywordtype}{string})\ end(\$lines));}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00278}00278\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\(\backslash\)strlen(\$key)\ ===\ 0)\ \{}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00279}00279\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ \textcolor{keyword}{new}\ DomainException(\textcolor{stringliteral}{'Key\ cannot\ be\ empty\ string'});}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00280}00280\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00281}00281\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ sodium\_crypto\_sign\_detached(\$msg,\ \$key);}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00282}00282\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{catch}\ (Exception\ \$e)\ \{}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00283}00283\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ \textcolor{keyword}{new}\ DomainException(\$e-\/>getMessage(),\ 0,\ \$e);}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00284}00284\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00285}00285\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00286}00286\ }
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00287}00287\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ \textcolor{keyword}{new}\ DomainException(\textcolor{stringliteral}{'Algorithm\ not\ supported'});}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00288}00288\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00289}00289\ }
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00303}00303\ \ \ \ \ \textcolor{keyword}{private}\ \textcolor{keyword}{static}\ \textcolor{keyword}{function}\ verify(}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00304}00304\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{string}\ \$msg,}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00305}00305\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{string}\ \$signature,}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00306}00306\ \ \ \ \ \ \ \ \ \$keyMaterial,}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00307}00307\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{string}\ \$alg}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00308}00308\ \ \ \ \ ):\ bool\ \{}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00309}00309\ \ \ \ \ \ \ \ \ if\ (empty(static::\$supported\_algs[\$alg]))\ \{}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00310}00310\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ \textcolor{keyword}{new}\ DomainException(\textcolor{stringliteral}{'Algorithm\ not\ supported'});}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00311}00311\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00312}00312\ }
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00313}00313\ \ \ \ \ \ \ \ \ list(\$function,\ \$algorithm)\ =\ static::\$supported\_algs[\$alg];}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00314}00314\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{switch}\ (\$function)\ \{}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00315}00315\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \textcolor{stringliteral}{'openssl'}:}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00316}00316\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \$success\ =\ \(\backslash\)openssl\_verify(\$msg,\ \$signature,\ \$keyMaterial,\ \$algorithm);\ \textcolor{comment}{//\ @phpstan-\/ignore-\/line}}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00317}00317\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\$success\ ===\ 1)\ \{}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00318}00318\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00319}00319\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00320}00320\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\$success\ ===\ 0)\ \{}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00321}00321\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00322}00322\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00323}00323\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ returns\ 1\ on\ success,\ 0\ on\ failure,\ -\/1\ on\ error.}}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00324}00324\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ \textcolor{keyword}{new}\ DomainException(}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00325}00325\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'OpenSSL\ error:\ '}\ .\ \(\backslash\)openssl\_error\_string()}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00326}00326\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ );}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00327}00327\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \textcolor{stringliteral}{'sodium\_crypto'}:}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00328}00328\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!\(\backslash\)function\_exists(\textcolor{stringliteral}{'sodium\_crypto\_sign\_verify\_detached'}))\ \{}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00329}00329\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ \textcolor{keyword}{new}\ DomainException(\textcolor{stringliteral}{'libsodium\ is\ not\ available'});}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00330}00330\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00331}00331\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!\(\backslash\)is\_string(\$keyMaterial))\ \{}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00332}00332\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ \textcolor{keyword}{new}\ InvalidArgumentException(\textcolor{stringliteral}{'key\ must\ be\ a\ string\ when\ using\ EdDSA'});}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00333}00333\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00334}00334\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{try}\ \{}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00335}00335\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ The\ last\ non-\/empty\ line\ is\ used\ as\ the\ key.}}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00336}00336\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \$lines\ =\ array\_filter(explode(\textcolor{stringliteral}{"{}\(\backslash\)n"{}},\ \$keyMaterial));}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00337}00337\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \$key\ =\ base64\_decode((\textcolor{keywordtype}{string})\ end(\$lines));}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00338}00338\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\(\backslash\)strlen(\$key)\ ===\ 0)\ \{}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00339}00339\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ \textcolor{keyword}{new}\ DomainException(\textcolor{stringliteral}{'Key\ cannot\ be\ empty\ string'});}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00340}00340\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00341}00341\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\(\backslash\)strlen(\$signature)\ ===\ 0)\ \{}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00342}00342\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ \textcolor{keyword}{new}\ DomainException(\textcolor{stringliteral}{'Signature\ cannot\ be\ empty\ string'});}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00343}00343\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00344}00344\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ sodium\_crypto\_sign\_verify\_detached(\$signature,\ \$msg,\ \$key);}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00345}00345\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{catch}\ (Exception\ \$e)\ \{}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00346}00346\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ \textcolor{keyword}{new}\ DomainException(\$e-\/>getMessage(),\ 0,\ \$e);}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00347}00347\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00348}00348\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \textcolor{stringliteral}{'hash\_hmac'}:}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00349}00349\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{default}:}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00350}00350\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!\(\backslash\)is\_string(\$keyMaterial))\ \{}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00351}00351\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ \textcolor{keyword}{new}\ InvalidArgumentException(\textcolor{stringliteral}{'key\ must\ be\ a\ string\ when\ using\ hmac'});}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00352}00352\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00353}00353\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \$hash\ =\ \(\backslash\)hash\_hmac(\$algorithm,\ \$msg,\ \$keyMaterial,\ \textcolor{keyword}{true});}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00354}00354\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ self::constantTimeEquals(\$hash,\ \$signature);}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00355}00355\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00356}00356\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00357}00357\ }
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00367}\mbox{\hyperlink{classFirebase_1_1JWT_1_1JWT_abcf1ffd37ae351f535526c0ad6f756ab}{00367}}\ \ \ \ \ \textcolor{keyword}{public}\ \textcolor{keyword}{static}\ \textcolor{keyword}{function}\ \mbox{\hyperlink{classFirebase_1_1JWT_1_1JWT_abcf1ffd37ae351f535526c0ad6f756ab}{jsonDecode}}(\textcolor{keywordtype}{string}\ \$input)}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00368}00368\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00369}00369\ \ \ \ \ \ \ \ \ \$obj\ =\ \(\backslash\)json\_decode(\$input,\ \textcolor{keyword}{false},\ 512,\ JSON\_BIGINT\_AS\_STRING);}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00370}00370\ }
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00371}00371\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\$errno\ =\ \(\backslash\)json\_last\_error())\ \{}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00372}00372\ \ \ \ \ \ \ \ \ \ \ \ \ self::handleJsonError(\$errno);}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00373}00373\ \ \ \ \ \ \ \ \ \}\ elseif\ (\$obj\ ===\ \textcolor{keyword}{null}\ \&\&\ \$input\ !==\ \textcolor{stringliteral}{'null'})\ \{}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00374}00374\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ \textcolor{keyword}{new}\ DomainException(\textcolor{stringliteral}{'Null\ result\ with\ non-\/null\ input'});}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00375}00375\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00376}00376\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \$obj;}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00377}00377\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00378}00378\ }
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00388}\mbox{\hyperlink{classFirebase_1_1JWT_1_1JWT_aae183f208acd86e837d44d7c7fbebf1b}{00388}}\ \ \ \ \ \textcolor{keyword}{public}\ \textcolor{keyword}{static}\ \textcolor{keyword}{function}\ \mbox{\hyperlink{classFirebase_1_1JWT_1_1JWT_aae183f208acd86e837d44d7c7fbebf1b}{jsonEncode}}(array\ \$input):\ string}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00389}00389\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00390}00390\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (PHP\_VERSION\_ID\ >=\ 50400)\ \{}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00391}00391\ \ \ \ \ \ \ \ \ \ \ \ \ \$json\ =\ \(\backslash\)json\_encode(\$input,\ \(\backslash\)JSON\_UNESCAPED\_SLASHES);}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00392}00392\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00393}00393\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ PHP\ 5.3\ only}}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00394}00394\ \ \ \ \ \ \ \ \ \ \ \ \ \$json\ =\ \(\backslash\)json\_encode(\$input);}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00395}00395\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00396}00396\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\$errno\ =\ \(\backslash\)json\_last\_error())\ \{}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00397}00397\ \ \ \ \ \ \ \ \ \ \ \ \ self::handleJsonError(\$errno);}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00398}00398\ \ \ \ \ \ \ \ \ \}\ elseif\ (\$json\ ===\ \textcolor{stringliteral}{'null'})\ \{}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00399}00399\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ \textcolor{keyword}{new}\ DomainException(\textcolor{stringliteral}{'Null\ result\ with\ non-\/null\ input'});}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00400}00400\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00401}00401\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\$json\ ===\ \textcolor{keyword}{false})\ \{}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00402}00402\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ \textcolor{keyword}{new}\ DomainException(\textcolor{stringliteral}{'Provided\ object\ could\ not\ be\ encoded\ to\ valid\ JSON'});}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00403}00403\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00404}00404\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \$json;}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00405}00405\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00406}00406\ }
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00416}\mbox{\hyperlink{classFirebase_1_1JWT_1_1JWT_ae16d583bf7034d13e4cd83dcd99dcfad}{00416}}\ \ \ \ \ \textcolor{keyword}{public}\ \textcolor{keyword}{static}\ \textcolor{keyword}{function}\ \mbox{\hyperlink{classFirebase_1_1JWT_1_1JWT_ae16d583bf7034d13e4cd83dcd99dcfad}{urlsafeB64Decode}}(\textcolor{keywordtype}{string}\ \$input):\ string}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00417}00417\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00418}00418\ \ \ \ \ \ \ \ \ return\ \(\backslash\)base64\_decode(self::convertBase64UrlToBase64(\$input));}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00419}00419\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00420}00420\ }
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00431}\mbox{\hyperlink{classFirebase_1_1JWT_1_1JWT_adaff823e66090cc2339f6e61136963e6}{00431}}\ \ \ \ \ \textcolor{keyword}{public}\ \textcolor{keyword}{static}\ \textcolor{keyword}{function}\ \mbox{\hyperlink{classFirebase_1_1JWT_1_1JWT_adaff823e66090cc2339f6e61136963e6}{convertBase64UrlToBase64}}(\textcolor{keywordtype}{string}\ \$input):\ string}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00432}00432\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00433}00433\ \ \ \ \ \ \ \ \ \$remainder\ =\ \(\backslash\)strlen(\$input)\ \%\ 4;}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00434}00434\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\$remainder)\ \{}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00435}00435\ \ \ \ \ \ \ \ \ \ \ \ \ \$padlen\ =\ 4\ -\/\ \$remainder;}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00436}00436\ \ \ \ \ \ \ \ \ \ \ \ \ \$input\ .=\ \(\backslash\)str\_repeat(\textcolor{charliteral}{'='},\ \$padlen);}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00437}00437\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00438}00438\ \ \ \ \ \ \ \ \ return\ \(\backslash\)strtr(\$input,\ \textcolor{stringliteral}{'-\/\_'},\ \textcolor{stringliteral}{'+/'});}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00439}00439\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00440}00440\ }
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00448}\mbox{\hyperlink{classFirebase_1_1JWT_1_1JWT_a669c4d494c1551263b75bfb62eba480a}{00448}}\ \ \ \ \ \textcolor{keyword}{public}\ \textcolor{keyword}{static}\ \textcolor{keyword}{function}\ \mbox{\hyperlink{classFirebase_1_1JWT_1_1JWT_a669c4d494c1551263b75bfb62eba480a}{urlsafeB64Encode}}(\textcolor{keywordtype}{string}\ \$input):\ string}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00449}00449\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00450}00450\ \ \ \ \ \ \ \ \ return\ \(\backslash\)str\_replace(\textcolor{charliteral}{'='},\ \textcolor{stringliteral}{''},\ \(\backslash\)strtr(\(\backslash\)base64\_encode(\$input),\ \textcolor{stringliteral}{'+/'},\ \textcolor{stringliteral}{'-\/\_'}));}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00451}00451\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00452}00452\ }
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00453}00453\ }
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00464}00464\ \ \ \ \ \textcolor{keyword}{private}\ \textcolor{keyword}{static}\ \textcolor{keyword}{function}\ getKey(}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00465}00465\ \ \ \ \ \ \ \ \ \$keyOrKeyArray,}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00466}00466\ \ \ \ \ \ \ \ \ ?\textcolor{keywordtype}{string}\ \$kid}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00467}00467\ \ \ \ \ ):\ \mbox{\hyperlink{classFirebase_1_1JWT_1_1Key}{Key}}\ \{}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00468}00468\ \ \ \ \ \ \ \ \ if\ (\$keyOrKeyArray\ instanceof\ \mbox{\hyperlink{classFirebase_1_1JWT_1_1Key}{Key}})\ \{}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00469}00469\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \$keyOrKeyArray;}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00470}00470\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00471}00471\ }
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00472}00472\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (empty(\$kid)\ \&\&\ \$kid\ !==\ \textcolor{charliteral}{'0'})\ \{}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00473}00473\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ \textcolor{keyword}{new}\ UnexpectedValueException(\textcolor{stringliteral}{'"{}kid"{}\ empty,\ unable\ to\ lookup\ correct\ key'});}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00474}00474\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00475}00475\ }
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00476}00476\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\$keyOrKeyArray\ instanceof\ CachedKeySet)\ \{}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00477}00477\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Skip\ "{}isset"{}\ check,\ as\ this\ will\ automatically\ refresh\ if\ not\ set}}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00478}00478\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \$keyOrKeyArray[\$kid];}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00479}00479\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00480}00480\ }
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00481}00481\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!isset(\$keyOrKeyArray[\$kid]))\ \{}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00482}00482\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ \textcolor{keyword}{new}\ UnexpectedValueException(\textcolor{stringliteral}{'"{}kid"{}\ invalid,\ unable\ to\ lookup\ correct\ key'});}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00483}00483\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00484}00484\ }
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00485}00485\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \$keyOrKeyArray[\$kid];}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00486}00486\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00487}00487\ }
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00493}\mbox{\hyperlink{classFirebase_1_1JWT_1_1JWT_a3b535adae2433765c1a6e485bc63333d}{00493}}\ \ \ \ \ \textcolor{keyword}{public}\ \textcolor{keyword}{static}\ \textcolor{keyword}{function}\ \mbox{\hyperlink{classFirebase_1_1JWT_1_1JWT_a3b535adae2433765c1a6e485bc63333d}{constantTimeEquals}}(\textcolor{keywordtype}{string}\ \$left,\ \textcolor{keywordtype}{string}\ \$right):\ bool}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00494}00494\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00495}00495\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\(\backslash\)function\_exists(\textcolor{stringliteral}{'hash\_equals'}))\ \{}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00496}00496\ \ \ \ \ \ \ \ \ \ \ \ \ return\ \(\backslash\)hash\_equals(\$left,\ \$right);}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00497}00497\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00498}00498\ \ \ \ \ \ \ \ \ \$len\ =\ \(\backslash\)min(self::safeStrlen(\$left),\ self::safeStrlen(\$right));}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00499}00499\ }
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00500}00500\ \ \ \ \ \ \ \ \ \$status\ =\ 0;}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00501}00501\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\$i\ =\ 0;\ \$i\ <\ \$len;\ \$i++)\ \{}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00502}00502\ \ \ \ \ \ \ \ \ \ \ \ \ \$status\ |=\ (\(\backslash\)ord(\$left[\$i])\ \string^\ \(\backslash\)ord(\$right[\$i]));}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00503}00503\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00504}00504\ \ \ \ \ \ \ \ \ \$status\ |=\ (self::safeStrlen(\$left)\ \string^\ self::safeStrlen(\$right));}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00505}00505\ }
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00506}00506\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ (\$status\ ===\ 0);}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00507}00507\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00508}00508\ }
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00518}00518\ \ \ \ \ \textcolor{keyword}{private}\ \textcolor{keyword}{static}\ \textcolor{keyword}{function}\ handleJsonError(\textcolor{keywordtype}{int}\ \$errno):\ void}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00519}00519\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00520}00520\ \ \ \ \ \ \ \ \ \$messages\ =\ [}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00521}00521\ \ \ \ \ \ \ \ \ \ \ \ \ JSON\_ERROR\_DEPTH\ =>\ \textcolor{stringliteral}{'Maximum\ stack\ depth\ exceeded'},}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00522}00522\ \ \ \ \ \ \ \ \ \ \ \ \ JSON\_ERROR\_STATE\_MISMATCH\ =>\ \textcolor{stringliteral}{'Invalid\ or\ malformed\ JSON'},}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00523}00523\ \ \ \ \ \ \ \ \ \ \ \ \ JSON\_ERROR\_CTRL\_CHAR\ =>\ \textcolor{stringliteral}{'Unexpected\ control\ character\ found'},}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00524}00524\ \ \ \ \ \ \ \ \ \ \ \ \ JSON\_ERROR\_SYNTAX\ =>\ \textcolor{stringliteral}{'Syntax\ error,\ malformed\ JSON'},}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00525}00525\ \ \ \ \ \ \ \ \ \ \ \ \ JSON\_ERROR\_UTF8\ =>\ \textcolor{stringliteral}{'Malformed\ UTF-\/8\ characters'}\ \textcolor{comment}{//PHP\ >=\ 5.3.3}}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00526}00526\ \ \ \ \ \ \ \ \ ];}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00527}00527\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ \textcolor{keyword}{new}\ DomainException(}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00528}00528\ \ \ \ \ \ \ \ \ \ \ \ \ isset(\$messages[\$errno])}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00529}00529\ \ \ \ \ \ \ \ \ \ \ \ \ ?\ \$messages[\$errno]}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00530}00530\ \ \ \ \ \ \ \ \ \ \ \ \ :\ \textcolor{stringliteral}{'Unknown\ JSON\ error:\ '}\ .\ \$errno}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00531}00531\ \ \ \ \ \ \ \ \ );}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00532}00532\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00533}00533\ }
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00541}00541\ \ \ \ \ \textcolor{keyword}{private}\ \textcolor{keyword}{static}\ \textcolor{keyword}{function}\ safeStrlen(\textcolor{keywordtype}{string}\ \$str):\ int}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00542}00542\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00543}00543\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\(\backslash\)function\_exists(\textcolor{stringliteral}{'mb\_strlen'}))\ \{}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00544}00544\ \ \ \ \ \ \ \ \ \ \ \ \ return\ \(\backslash\)mb\_strlen(\$str,\ \textcolor{stringliteral}{'8bit'});}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00545}00545\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00546}00546\ \ \ \ \ \ \ \ \ return\ \(\backslash\)strlen(\$str);}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00547}00547\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00548}00548\ }
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00555}00555\ \ \ \ \ \textcolor{keyword}{private}\ \textcolor{keyword}{static}\ \textcolor{keyword}{function}\ signatureToDER(\textcolor{keywordtype}{string}\ \$sig):\ string}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00556}00556\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00557}00557\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Separate\ the\ signature\ into\ r-\/value\ and\ s-\/value}}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00558}00558\ \ \ \ \ \ \ \ \ \$length\ =\ max(1,\ (\textcolor{keywordtype}{int})\ (\(\backslash\)strlen(\$sig)\ /\ 2));}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00559}00559\ \ \ \ \ \ \ \ \ list(\$r,\ \$s)\ =\ \(\backslash\)str\_split(\$sig,\ \$length);}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00560}00560\ }
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00561}00561\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Trim\ leading\ zeros}}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00562}00562\ \ \ \ \ \ \ \ \ \$r\ =\ \(\backslash\)ltrim(\$r,\ \textcolor{stringliteral}{"{}\(\backslash\)x00"{}});}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00563}00563\ \ \ \ \ \ \ \ \ \$s\ =\ \(\backslash\)ltrim(\$s,\ \textcolor{stringliteral}{"{}\(\backslash\)x00"{}});}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00564}00564\ }
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00565}00565\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Convert\ r-\/value\ and\ s-\/value\ from\ unsigned\ big-\/endian\ integers\ to}}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00566}00566\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ signed\ two's\ complement}}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00567}00567\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\(\backslash\)ord(\$r[0])\ >\ 0x7f)\ \{}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00568}00568\ \ \ \ \ \ \ \ \ \ \ \ \ \$r\ =\ \textcolor{stringliteral}{"{}\(\backslash\)x00"{}}\ .\ \$r;}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00569}00569\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00570}00570\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\(\backslash\)ord(\$s[0])\ >\ 0x7f)\ \{}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00571}00571\ \ \ \ \ \ \ \ \ \ \ \ \ \$s\ =\ \textcolor{stringliteral}{"{}\(\backslash\)x00"{}}\ .\ \$s;}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00572}00572\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00573}00573\ }
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00574}00574\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ self::encodeDER(}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00575}00575\ \ \ \ \ \ \ \ \ \ \ \ \ self::ASN1\_SEQUENCE,}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00576}00576\ \ \ \ \ \ \ \ \ \ \ \ \ self::encodeDER(self::ASN1\_INTEGER,\ \$r)\ .}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00577}00577\ \ \ \ \ \ \ \ \ \ \ \ \ self::encodeDER(self::ASN1\_INTEGER,\ \$s)}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00578}00578\ \ \ \ \ \ \ \ \ );}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00579}00579\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00580}00580\ }
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00589}00589\ \ \ \ \ \textcolor{keyword}{private}\ \textcolor{keyword}{static}\ \textcolor{keyword}{function}\ encodeDER(\textcolor{keywordtype}{int}\ \$type,\ \textcolor{keywordtype}{string}\ \$value):\ string}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00590}00590\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00591}00591\ \ \ \ \ \ \ \ \ \$tag\_header\ =\ 0;}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00592}00592\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\$type\ ===\ self::ASN1\_SEQUENCE)\ \{}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00593}00593\ \ \ \ \ \ \ \ \ \ \ \ \ \$tag\_header\ |=\ 0x20;}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00594}00594\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00595}00595\ }
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00596}00596\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Type}}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00597}00597\ \ \ \ \ \ \ \ \ \$der\ =\ \(\backslash\)chr(\$tag\_header\ |\ \$type);}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00598}00598\ }
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00599}00599\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Length}}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00600}00600\ \ \ \ \ \ \ \ \ \$der\ .=\ \(\backslash\)chr(\(\backslash\)strlen(\$value));}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00601}00601\ }
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00602}00602\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \$der\ .\ \$value;}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00603}00603\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00604}00604\ }
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00613}00613\ \ \ \ \ \textcolor{keyword}{private}\ \textcolor{keyword}{static}\ \textcolor{keyword}{function}\ signatureFromDER(\textcolor{keywordtype}{string}\ \$der,\ \textcolor{keywordtype}{int}\ \$keySize):\ string}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00614}00614\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00615}00615\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ OpenSSL\ returns\ the\ ECDSA\ signatures\ as\ a\ binary\ ASN.1\ DER\ SEQUENCE}}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00616}00616\ \ \ \ \ \ \ \ \ list(\$offset,\ \$\_)\ =\ self::readDER(\$der);}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00617}00617\ \ \ \ \ \ \ \ \ list(\$offset,\ \$r)\ =\ self::readDER(\$der,\ \$offset);}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00618}00618\ \ \ \ \ \ \ \ \ list(\$offset,\ \$s)\ =\ self::readDER(\$der,\ \$offset);}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00619}00619\ }
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00620}00620\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Convert\ r-\/value\ and\ s-\/value\ from\ signed\ two's\ compliment\ to\ unsigned}}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00621}00621\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ big-\/endian\ integers}}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00622}00622\ \ \ \ \ \ \ \ \ \$r\ =\ \(\backslash\)ltrim(\$r,\ \textcolor{stringliteral}{"{}\(\backslash\)x00"{}});}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00623}00623\ \ \ \ \ \ \ \ \ \$s\ =\ \(\backslash\)ltrim(\$s,\ \textcolor{stringliteral}{"{}\(\backslash\)x00"{}});}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00624}00624\ }
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00625}00625\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Pad\ out\ r\ and\ s\ so\ that\ they\ are\ \$keySize\ bits\ long}}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00626}00626\ \ \ \ \ \ \ \ \ \$r\ =\ \(\backslash\)str\_pad(\$r,\ \$keySize\ /\ 8,\ \textcolor{stringliteral}{"{}\(\backslash\)x00"{}},\ STR\_PAD\_LEFT);}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00627}00627\ \ \ \ \ \ \ \ \ \$s\ =\ \(\backslash\)str\_pad(\$s,\ \$keySize\ /\ 8,\ \textcolor{stringliteral}{"{}\(\backslash\)x00"{}},\ STR\_PAD\_LEFT);}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00628}00628\ }
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00629}00629\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \$r\ .\ \$s;}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00630}00630\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00631}00631\ }
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00641}00641\ \ \ \ \ \textcolor{keyword}{private}\ \textcolor{keyword}{static}\ \textcolor{keyword}{function}\ readDER(\textcolor{keywordtype}{string}\ \$der,\ \textcolor{keywordtype}{int}\ \$offset\ =\ 0):\ array}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00642}00642\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00643}00643\ \ \ \ \ \ \ \ \ \$pos\ =\ \$offset;}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00644}00644\ \ \ \ \ \ \ \ \ \$size\ =\ \(\backslash\)strlen(\$der);}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00645}00645\ \ \ \ \ \ \ \ \ \$constructed\ =\ (\(\backslash\)ord(\$der[\$pos])\ >>\ 5)\ \&\ 0x01;}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00646}00646\ \ \ \ \ \ \ \ \ \$type\ =\ \(\backslash\)ord(\$der[\$pos++])\ \&\ 0x1f;}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00647}00647\ }
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00648}00648\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Length}}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00649}00649\ \ \ \ \ \ \ \ \ \$len\ =\ \(\backslash\)ord(\$der[\$pos++]);}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00650}00650\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\$len\ \&\ 0x80)\ \{}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00651}00651\ \ \ \ \ \ \ \ \ \ \ \ \ \$n\ =\ \$len\ \&\ 0x1f;}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00652}00652\ \ \ \ \ \ \ \ \ \ \ \ \ \$len\ =\ 0;}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00653}00653\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{while}\ (\$n-\/-\/\ \&\&\ \$pos\ <\ \$size)\ \{}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00654}00654\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \$len\ =\ (\$len\ <<\ 8)\ |\ \(\backslash\)ord(\$der[\$pos++]);}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00655}00655\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00656}00656\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00657}00657\ }
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00658}00658\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Value}}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00659}00659\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\$type\ ===\ self::ASN1\_BIT\_STRING)\ \{}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00660}00660\ \ \ \ \ \ \ \ \ \ \ \ \ \$pos++;\ \textcolor{comment}{//\ Skip\ the\ first\ contents\ octet\ (padding\ indicator)}}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00661}00661\ \ \ \ \ \ \ \ \ \ \ \ \ \$data\ =\ \(\backslash\)substr(\$der,\ \$pos,\ \$len\ -\/\ 1);}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00662}00662\ \ \ \ \ \ \ \ \ \ \ \ \ \$pos\ +=\ \$len\ -\/\ 1;}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00663}00663\ \ \ \ \ \ \ \ \ \}\ elseif\ (!\$constructed)\ \{}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00664}00664\ \ \ \ \ \ \ \ \ \ \ \ \ \$data\ =\ \(\backslash\)substr(\$der,\ \$pos,\ \$len);}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00665}00665\ \ \ \ \ \ \ \ \ \ \ \ \ \$pos\ +=\ \$len;}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00666}00666\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00667}00667\ \ \ \ \ \ \ \ \ \ \ \ \ \$data\ =\ \textcolor{keyword}{null};}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00668}00668\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00669}00669\ }
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00670}00670\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ [\$pos,\ \$data];}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00671}00671\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{JWT_8php_source_l00672}00672\ \}}

\end{DoxyCode}
